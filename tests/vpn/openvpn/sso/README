OpenVPN plugin examples.                            Daniel Kubec <niel@rtfm.cz>

Examples provided:

sso.c   -- HTTP (SSO) Example based on TLS Keying Material Exporters [RFC-5705]
                                     (openvpn/doc/keying-material-exporter.txt)

Requires:
OpenVPN RFC-5705 Support, OpenSSL >= 1.0.1

Files:
  http-server.py -- Example HTTP Server listen  0.0.0.0:8080
  http-client.py -- Example HTTP Client connect 10.8.0.1:8080 [GET /$SESSIONID]

  server.ovpn    -- Example HTTP SSO VPN Server configuration
  client.ovpn    -- Example HTTP SSO VPN Client configuration 

  sso.c, sso.so  -- Example OpenVPN Client and Server plugin

To build:
  ./build sso

To use in OpenVPN:

Enter openvpn/sample/sample-plugins/sso directory

$ ./http-server.py 
$ openvpn --config ./server.ovpn
$ openvpn --config ./client.ovpn

Test:

HTTP_SERVER:
http-server.py
################
http server started
session file: /tmp/openvpn_sso_a5885abc84d361803f58ede1ef9c0adf99e720cd
10.8.0.1 - - [02/Apr/2015 15:03:33] "GET /a5885abc84d361803f58ede1ef9c0adf99e720cd HTTP/1.1" 200 -
session user: Test-Client
session key:  a5885abc84d361803f58ede1ef9c0adf99e720cd

openvpn --config ./server.ovpn
##############################

PLUGIN SSO: app session created
PLUGIN_CALL: POST ./sso.so/PLUGIN_TLS_VERIFY status=0
PLUGIN SSO: app session key:  a5885abc84d361803f58ede1ef9c0adf99e720cd
PLUGIN SSO: app session file: /tmp/openvpn_sso_a5885abc84d361803f58ede1ef9c0adf99e720cd
PLUGIN SSO: app session user: Test-Client

openvpn --config ./client.ovpn
##############################
PLUGIN SSO: app session created
PLUGIN_CALL: POST ./sso.so/PLUGIN_TLS_VERIFY status=0
PLUGIN SSO: app session key:  a5885abc84d361803f58ede1ef9c0adf99e720cd
PLUGIN SSO: app session file: /tmp/openvpn_sso_user
PLUGIN_CALL: POST ./sso.so/PLUGIN_TLS_FINAL status=0
PLUGIN SSO ./http-client.py tun1 1500 1544 10.8.0.6 10.8.0.5 init
<html><body><h1>Greetings Test-Client. You are authorized</h1></body></html>


Note: 

http_client.py is called automatically 
[client.ovpn]
...
      script-security 2
      up ./http-client.py
...
